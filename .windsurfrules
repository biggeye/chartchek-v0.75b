# You are development assistance for chartChek
**a project that uses NextJS 15 and OpenAI's Assistants API to provide instant, accurate, and actionable insights for behavioral health facilities.**

Always make sure to reference the current OpenAI documentation before writing new code.  Especially with regards to the Assistant API (v2 beta).
Ask questions if you're not 100% certain about the scope of what you're doing.  For instance, if type definitions are missing, ask where the current type definitions are.  Always be looking for more efficient ways to do things, but make sure to not
break current logic or create new infrastructure without asking the user first.

when refactoring always consider the source of truth hierarchy:

**Source of truth hierarchy**:
1) supabase table schema
2) type definitions (/types/store/ * -> /types/database/index.ts, types/store/document/index.ts, types/store/chat.ts, types/store/streaming.ts)
3) zustand state store (/store/chatStore.ts & /store/streamingStore.ts & /store/documentStore.ts)

**we are migrating away from (/store/assistantStore.ts) in favor of (/store/clientStore.ts)**
**we are also migrating away from (/components/chat/AssistantChat.tsx) in favor of (/components/chat/Chat.tsx)**


**Always make sure to reference the current OpenAI documentation before writing new code.  Especially with regards to the Assistant API (v2 beta).**

supabase tables:


[
  {
    "table_name": "chat_messages",
    "column_name": "id",
    "data_type": "uuid"
  },
  {
    "table_name": "chat_messages",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "chat_messages",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "chat_messages",
    "column_name": "role",
    "data_type": "text"
  },
  {
    "table_name": "chat_messages",
    "column_name": "message_id",
    "data_type": "text"
  },
  {
    "table_name": "chat_messages",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "chat_messages",
    "column_name": "thread_id",
    "data_type": "text"
  },
  {
    "table_name": "chat_messages",
    "column_name": "file_ids",
    "data_type": "ARRAY"
  },
  {
    "table_name": "chat_messages",
    "column_name": "metadata",
    "data_type": "jsonb"
  },
  {
    "table_name": "chat_messages",
    "column_name": "content",
    "data_type": "jsonb"
  },
  {
    "table_name": "chat_threads",
    "column_name": "id",
    "data_type": "uuid"
  },
  {
    "table_name": "chat_threads",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "chat_threads",
    "column_name": "assistant_id",
    "data_type": "text"
  },
  {
    "table_name": "chat_threads",
    "column_name": "status",
    "data_type": "USER-DEFINED"
  },
  {
    "table_name": "chat_threads",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "chat_threads",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "chat_threads",
    "column_name": "metadata",
    "data_type": "ARRAY"
  },
  {
    "table_name": "chat_threads",
    "column_name": "thread_id",
    "data_type": "text"
  },
  {
    "table_name": "chat_threads",
    "column_name": "title",
    "data_type": "text"
  },
  {
    "table_name": "chat_threads",
    "column_name": "last_message_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "chat_threads",
    "column_name": "is_active",
    "data_type": "boolean"
  },
  {
    "table_name": "chat_threads",
    "column_name": "vector_store_id",
    "data_type": "text"
  },
  {
    "table_name": "documents",
    "column_name": "document_id",
    "data_type": "uuid"
  },
  {
    "table_name": "documents",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "documents",
    "column_name": "facility_id",
    "data_type": "uuid"
  },
  {
    "table_name": "documents",
    "column_name": "bucket",
    "data_type": "character varying"
  },
  {
    "table_name": "documents",
    "column_name": "file_path",
    "data_type": "text"
  },
  {
    "table_name": "documents",
    "column_name": "file_name",
    "data_type": "character varying"
  },
  {
    "table_name": "documents",
    "column_name": "file_type",
    "data_type": "character varying"
  },
  {
    "table_name": "documents",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "documents",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "documents",
    "column_name": "file_size",
    "data_type": "character varying"
  },
  {
    "table_name": "documents",
    "column_name": "metadata",
    "data_type": "ARRAY"
  },
  {
    "table_name": "documents",
    "column_name": "openai_file_id",
    "data_type": "text"
  },
  {
    "table_name": "facilities",
    "column_name": "facility_id",
    "data_type": "uuid"
  },
  {
    "table_name": "facilities",
    "column_name": "owner_id",
    "data_type": "uuid"
  },
  {
    "table_name": "facilities",
    "column_name": "name",
    "data_type": "character varying"
  },
  {
    "table_name": "facilities",
    "column_name": "address",
    "data_type": "text"
  },
  {
    "table_name": "facilities",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "facilities",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "profiles",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "profiles",
    "column_name": "first_name",
    "data_type": "character varying"
  },
  {
    "table_name": "profiles",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "profiles",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "profiles",
    "column_name": "last_name",
    "data_type": "character varying"
  },
  {
    "table_name": "profiles",
    "column_name": "is_owner",
    "data_type": "boolean"
  },
  {
    "table_name": "profiles",
    "column_name": "email",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "id",
    "data_type": "uuid"
  },
  {
    "table_name": "user_assistants",
    "column_name": "created_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "user_assistants",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "user_assistants",
    "column_name": "assistant_id",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "name",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "instructions",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "description",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "model",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "tools",
    "data_type": "ARRAY"
  },
  {
    "table_name": "user_assistants",
    "column_name": "file_ids",
    "data_type": "ARRAY"
  },
  {
    "table_name": "user_assistants",
    "column_name": "metadata",
    "data_type": "jsonb"
  },
  {
    "table_name": "user_assistants",
    "column_name": "is_active",
    "data_type": "boolean"
  },
  {
    "table_name": "user_assistants",
    "column_name": "vector_store_id",
    "data_type": "text"
  },
  {
    "table_name": "user_assistants",
    "column_name": "updated_at",
    "data_type": "timestamp with time zone"
  },
  {
    "table_name": "user_facilities",
    "column_name": "user_id",
    "data_type": "uuid"
  },
  {
    "table_name": "user_facilities",
    "column_name": "facility_id",
    "data_type": "uuid"
  },
  {
    "table_name": "user_facilities",
    "column_name": "role",
    "data_type": "USER-DEFINED"
  },
  {
    "table_name": "user_facilities",
    "column_name": "assigned_at",
    "data_type": "timestamp with time zone"
  }
]